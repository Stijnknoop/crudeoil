name: Oil Trading Daily Report

on:
  schedule:
    # 08:00 UTC = 09:00/10:00 NL tijd
    - cron: '0 8 * * *'
  workflow_dispatch: # Knop om handmatig te testen

jobs:
  report:
    runs-on: ubuntu-latest
    # Belangrijk: Geef toestemming om bestanden aan de repo toe te voegen
    permissions:
      contents: write
      
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install Libraries
        run: pip install pandas numpy matplotlib scikit-learn

      - name: Draai Rapportage Script
        run: python daily_report.py

      - name: Push Resultaten naar Repo
        run: |
          git config --global user.name 'Oil Bot'
          git config --global user.email 'bot@trading.com'
          git add trading_log.csv last_day_plot.png
          # Alleen committen als er wijzigingen zijn
          git commit -m "Daily update $(date +'%Y-%m-%d')" || exit 0
          git push
